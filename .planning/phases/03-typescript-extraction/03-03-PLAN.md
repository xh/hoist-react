---
phase: 03-typescript-extraction
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/03-typescript-extraction/03-TYPEDOC-SPIKE.md
autonomous: true

must_haves:
  truths:
    - "TypeDoc was installed temporarily and run against hoist-react source files"
    - "JSON output generation was tested and results documented"
    - "HTML output generation was tested and results documented"
    - "Each risk area (decorators, barrel exports, Object.freeze enums, path aliases) has a pass/fail finding"
    - "TypeDoc dependency was removed after the spike completed"
    - "A written spike report exists with clear recommendations"
  artifacts:
    - path: ".planning/phases/03-typescript-extraction/03-TYPEDOC-SPIKE.md"
      provides: "TypeDoc validation spike findings with pass/fail for each risk area"
  key_links: []
---

<objective>
Execute the TypeDoc validation spike (HDOC-01) to determine whether TypeDoc can generate usable
documentation for hoist-react.

Purpose: This spike answers a key open question: can TypeDoc handle hoist-react's decorator
patterns, barrel exports, and Object.freeze enum pattern? The findings inform whether TypeDoc is
viable for future human-browsable docs or if ts-morph becomes the sole extraction source.

Output: `03-TYPEDOC-SPIKE.md` with pass/fail findings for each risk area. TypeDoc dependency
removed after spike.
</objective>

<execution_context>
@/Users/amcclain/.claude/get-shit-done/workflows/execute-plan.md
@/Users/amcclain/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-typescript-extraction/03-RESEARCH.md

# Repo tsconfig (TypeDoc will use this)
@tsconfig.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install TypeDoc and run validation tests</name>
  <files>.planning/phases/03-typescript-extraction/03-TYPEDOC-SPIKE.md</files>
  <action>
Execute the TypeDoc spike as defined in 03-RESEARCH.md section "TypeDoc Spike (HDOC-01) Approach".

**Step 1: Install TypeDoc temporarily**
```bash
yarn add -D typedoc
```

**Step 2: Create a minimal typedoc.json config**
Create a temporary `typedoc.json` at the repo root (will be deleted after spike). Use these settings:
```json
{
  "entryPoints": ["./core/index.ts", "./data/index.ts", "./cmp/index.ts", "./svc/index.ts"],
  "tsconfig": "./tsconfig.json",
  "out": "./build/typedoc-html",
  "json": "./build/typedoc.json",
  "exclude": ["**/node_modules/**", "**/mcp/**", "**/build/**"],
  "excludeExternals": true
}
```
Start with a subset of entry points (core, data, cmp, svc) -- these cover the main framework
surface area and include the key patterns to test.

**Step 3: Run TypeDoc JSON output**
```bash
npx typedoc --json build/typedoc.json
```
Check the output:
- Does it complete without errors?
- Does the JSON contain class entries? Check for GridModel, Store, HoistModel.
- Are decorated properties present? Check for @observable, @bindable annotations.
- Are barrel re-exports resolved? Check if GridModel appears from cmp/grid, not just cmp/index.

**Step 4: Run TypeDoc HTML output**
```bash
npx typedoc --out build/typedoc-html
```
Check:
- Does HTML generation complete?
- Are class pages generated?
- Is the output usable/navigable?

**Step 5: Test specific risk areas**

For each risk area, document pass/fail:

1. **experimentalDecorators** -- Do decorated class members (e.g. @observable properties in
   GridModel or any HoistModel subclass) appear in the output with their decorator annotations?

2. **Barrel exports** -- Does `export * from './grid/GridModel'` in cmp/index.ts result in
   GridModel being documented? Or is it missing/duplicated?

3. **Object.freeze enums** -- Does `export const RefreshMode = Object.freeze({...})` with
   companion `export type RefreshMode = ...` appear in the output? Check in core/index.ts or
   wherever RefreshMode is defined.

4. **Path aliases** -- Does TypeDoc resolve `@xh/hoist/*` imports correctly?

5. **JSON quality** -- Is the JSON output structured enough to be programmatically consumed?
   Could it supplement ts-morph extraction?

**Step 6: Write findings**

Create `03-TYPEDOC-SPIKE.md` with this structure:
```markdown
# TypeDoc Validation Spike (HDOC-01)

**Date:** YYYY-MM-DD
**TypeDoc version:** 0.28.x
**Verdict:** [VIABLE / PARTIALLY VIABLE / NOT VIABLE]

## Test Configuration
[typedoc.json used, entry points, etc.]

## Risk Area Results

### 1. experimentalDecorators
**Result:** PASS / FAIL
[Details of what worked/didn't]

### 2. Barrel Exports
**Result:** PASS / FAIL
[Details]

### 3. Object.freeze Enums
**Result:** PASS / FAIL
[Details]

### 4. Path Aliases
**Result:** PASS / FAIL
[Details]

### 5. JSON Output Quality
**Result:** PASS / FAIL
[Details]

## Errors/Warnings
[Any TypeDoc errors or warnings encountered]

## Recommendation
[What this means for the project going forward]
```

**Step 7: Clean up**
```bash
# Remove TypeDoc
yarn remove typedoc

# Remove temporary config and output
rm -f typedoc.json
rm -rf build/typedoc-html build/typedoc.json
```

Do NOT commit the typedoc.json or build output -- only commit the spike report.
  </action>
  <verify>
Verify typedoc is removed: `! grep typedoc package.json` (should not find it).
Verify spike report exists: `test -f .planning/phases/03-typescript-extraction/03-TYPEDOC-SPIKE.md`.
Verify no leftover artifacts: `! test -f typedoc.json && ! test -d build/typedoc-html`.
  </verify>
  <done>
TypeDoc spike report exists with pass/fail findings for all 5 risk areas (experimentalDecorators,
barrel exports, Object.freeze enums, path aliases, JSON quality). TypeDoc dependency removed.
No temporary artifacts left in the repo.
  </done>
</task>

</tasks>

<verification>
After task completes:
1. 03-TYPEDOC-SPIKE.md exists with structured findings
2. Each of the 5 risk areas has a clear PASS/FAIL result
3. A verdict (VIABLE / PARTIALLY VIABLE / NOT VIABLE) is stated
4. TypeDoc is not in package.json devDependencies
5. No typedoc.json or build/typedoc-* artifacts remain
6. The report includes a recommendation for the project going forward
</verification>

<success_criteria>
HDOC-01 requirement is fulfilled: TypeDoc validation spike completed with documented findings on
whether TypeDoc can handle hoist-react's decorator patterns, barrel exports, and
experimentalDecorators configuration. The recommendation is clear and actionable.
</success_criteria>

<output>
After completion, create `.planning/phases/03-typescript-extraction/03-03-SUMMARY.md`
</output>
