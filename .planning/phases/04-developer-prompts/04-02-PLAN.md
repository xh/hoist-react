---
phase: 04-developer-prompts
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - mcp/prompts/grid.ts
  - mcp/prompts/form.ts
  - mcp/prompts/tabs.ts
  - mcp/prompts/index.ts
autonomous: true

must_haves:
  truths:
    - "LLM can invoke create-grid prompt and receive structured output with grid documentation, GridModel type info, conventions, and code template"
    - "LLM can invoke create-form prompt and receive structured output with form documentation, FormModel/FieldModel type info, validation rules, and code template"
    - "LLM can invoke create-tab-container prompt and receive structured output with tab documentation, TabContainerModel type info, and code template"
    - "Each prompt produces 2000-4000 tokens of structured markdown content"
    - "Each prompt references relevant MCP tools for further exploration"
  artifacts:
    - path: "mcp/prompts/grid.ts"
      provides: "Grid panel creation prompt with documentation and type composition"
      exports: ["buildGridPrompt"]
    - path: "mcp/prompts/form.ts"
      provides: "Form creation prompt with documentation and type composition"
      exports: ["buildFormPrompt"]
    - path: "mcp/prompts/tabs.ts"
      provides: "Tab container creation prompt with documentation and type composition"
      exports: ["buildTabsPrompt"]
    - path: "mcp/prompts/index.ts"
      provides: "Updated registration wiring full prompt builders instead of stubs"
      contains: "buildGridPrompt"
  key_links:
    - from: "mcp/prompts/grid.ts"
      to: "mcp/prompts/util.ts"
      via: "loadDoc, extractSection, formatSymbolSummary, formatKeyMembers, hoistConventionsSection imports"
      pattern: "import.*from.*util"
    - from: "mcp/prompts/form.ts"
      to: "mcp/prompts/util.ts"
      via: "loadDoc, extractSection, formatSymbolSummary, formatKeyMembers, hoistConventionsSection imports"
      pattern: "import.*from.*util"
    - from: "mcp/prompts/tabs.ts"
      to: "mcp/prompts/util.ts"
      via: "loadDoc, extractSection, formatSymbolSummary, formatKeyMembers, hoistConventionsSection imports"
      pattern: "import.*from.*util"
    - from: "mcp/prompts/index.ts"
      to: "mcp/prompts/grid.ts"
      via: "buildGridPrompt import and prompt callback"
      pattern: "buildGridPrompt"
    - from: "mcp/prompts/index.ts"
      to: "mcp/prompts/form.ts"
      via: "buildFormPrompt import and prompt callback"
      pattern: "buildFormPrompt"
    - from: "mcp/prompts/index.ts"
      to: "mcp/prompts/tabs.ts"
      via: "buildTabsPrompt import and prompt callback"
      pattern: "buildTabsPrompt"
---

<objective>
Implement the three developer prompt builders (grid, form, tabs) with full content composition from documentation and type registries, then wire them into the registration module.

Purpose: This is the core deliverable of Phase 4 -- each prompt composes relevant documentation excerpts, type signatures, Hoist conventions, and code templates into structured markdown that gives an LLM everything it needs to generate correct Hoist-idiomatic code for that task.

Output: `mcp/prompts/grid.ts`, `mcp/prompts/form.ts`, `mcp/prompts/tabs.ts` (full implementations), updated `mcp/prompts/index.ts` (wired to real builders)
</objective>

<execution_context>
@/Users/amcclain/.claude/get-shit-done/workflows/execute-plan.md
@/Users/amcclain/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-developer-prompts/04-RESEARCH.md
@.planning/phases/04-developer-prompts/04-01-SUMMARY.md

# Prompt utilities created in Plan 01
@mcp/prompts/util.ts
@mcp/prompts/index.ts

# Documentation sources the prompts will reference
@cmp/grid/README.md
@cmp/form/README.md
@cmp/tab/README.md
@core/README.md
@AGENTS.md

# Existing registries for understanding API surface
@mcp/data/doc-registry.ts
@mcp/data/ts-registry.ts

# Sample apps for real-world patterns (read for reference, not import)
# Review grid/form/tab usage patterns in Toolbox examples
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement grid and form prompt builders</name>
  <files>mcp/prompts/grid.ts, mcp/prompts/form.ts</files>
  <action>
**Create `mcp/prompts/grid.ts`:**

Export `async function buildGridPrompt(args: {dataFields?: string; features?: string}): Promise<GetPromptResult>`.

Import `GetPromptResult` from `@modelcontextprotocol/sdk/types.js`. Import `loadDoc`, `extractSection`, `formatSymbolSummary`, `formatKeyMembers`, `hoistConventionsSection` from `./util.js`.

Implementation:
1. Parse args: split `dataFields` on comma, trim, filter empty. Parse `features` the same way. Default to empty arrays if undefined.
2. Load documentation: `loadDoc('cmp/grid')` for grid README, `loadDoc('core')` for core README.
3. Extract relevant sections from grid doc. Target section names to extract (try each, skip if not found):
   - Look for sections about column configuration, store/data configuration, and grid setup patterns
   - Use `extractSection()` for each, concatenating found sections
4. Get type information:
   - `formatSymbolSummary('GridModel')` for the class overview
   - `formatKeyMembers('GridModel', ['store', 'columns', 'sortBy', 'selModel', 'groupBy', 'emptyText', 'onRowDoubleClicked'])` for key members
   - `formatSymbolSummary('Column')` for column reference (brief)
5. Build code template section that adapts to provided args:
   - Model file template showing class extending HoistModel with @managed GridModel
   - Show field definitions if dataFields provided, otherwise show placeholder `{fieldName: {type: 'string'}}`
   - Show column definitions matching fields if provided
   - Include `doLoadAsync` skeleton
   - Component file template showing `hoistCmp.factory()` with `grid({model: model.gridModel})`
   - If features include specific items (sorting, grouping, selection, etc.), include those in the GridModel config
6. Compose all sections into a single markdown string with clear headers:
   - `# Task: Create a Hoist Grid Panel`
   - Conventions section (from `hoistConventionsSection()`)
   - Grid documentation excerpts
   - GridModel API reference (symbol summary + key members)
   - Code template
   - "Next Steps" section pointing to `hoist-search-docs`, `hoist-get-members GridModel`, `hoist-search-symbols` tools for more detail
7. Return `{ description: 'Hoist grid panel creation guide...', messages: [{ role: 'user', content: { type: 'text', text } }] }`

Target output size: ~2500-3500 tokens. Extract relevant excerpts from docs, do NOT embed entire READMEs.

**Create `mcp/prompts/form.ts`:**

Export `async function buildFormPrompt(args: {fields?: string; validation?: string}): Promise<GetPromptResult>`.

Implementation follows same pattern as grid:
1. Parse args: split `fields` on comma. Parse `validation` as a boolean-ish string (treat "false"/"no" as false, everything else as true, default true).
2. Load documentation: `loadDoc('cmp/form')` for form README, `loadDoc('cmp/input')` for input README.
3. Extract relevant sections about FormModel setup, field configuration, validation rules.
4. Get type information:
   - `formatSymbolSummary('FormModel')` for the class overview
   - `formatKeyMembers('FormModel', ['fields', 'values', 'isValid', 'isDirty', 'init', 'reset', 'getData'])` for key members
   - `formatSymbolSummary('FieldModel')` for field reference
5. Build code template:
   - Model file with @managed FormModel, field definitions matching provided field names
   - If validation enabled, include validation rules examples (required, lengthIs, numberIs, custom)
   - Component file with form layout using `formField()` + input components (`textInput`, `numberInput`, `dateInput`, `select`, `switchInput`)
   - Include the `form({model: model.formModel})` wrapper pattern
6. Compose with same structure: Task header, conventions, doc excerpts, API reference, code template, next steps.
7. Return GetPromptResult.

Target output size: ~2500-3500 tokens.

For both files: Use JSDoc on the exported function. Follow the established code style (explicit types, consistent formatting with other mcp/ modules).
  </action>
  <verify>
1. Run `npx tsc -p mcp/tsconfig.json --noEmit` -- no type errors.
2. Verify each file exports the expected function name.
3. Review that doc section extraction targets use section names that actually exist in the README files (read the READMEs to confirm header names).
  </verify>
  <done>
`mcp/prompts/grid.ts` exports `buildGridPrompt` that composes grid documentation, type info, conventions, and code template into a structured GetPromptResult. `mcp/prompts/form.ts` exports `buildFormPrompt` with equivalent composition for forms. Both type-check cleanly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement tab container prompt builder and wire all prompts into registration</name>
  <files>mcp/prompts/tabs.ts, mcp/prompts/index.ts</files>
  <action>
**Create `mcp/prompts/tabs.ts`:**

Export `async function buildTabsPrompt(args: {tabs?: string; routing?: string}): Promise<GetPromptResult>`.

Implementation:
1. Parse args: split `tabs` on comma for tab names. Parse `routing` as boolean-ish (default false).
2. Load documentation: `loadDoc('cmp/tab')` for tab README.
3. Extract relevant sections about TabContainerModel setup, rendering modes, routing integration.
4. Get type information:
   - `formatSymbolSummary('TabContainerModel')` for the class overview
   - `formatKeyMembers('TabContainerModel', ['tabs', 'activeTabId', 'route', 'switcherPosition', 'refreshMode', 'renderMode'])` for key members
5. Build code template:
   - Model file with @managed TabContainerModel, tab definitions using provided tab names or placeholders
   - Each tab with id, title, and content component reference
   - If routing enabled, include `route` property in TabContainerModel config and mention URL routing integration
   - Component file with `tabContainer({model: model.tabContainerModel})` pattern
   - Show how to create content panel components for each tab
6. Compose with standard structure: Task header, conventions, doc excerpts, API reference, code template, next steps.
7. Return GetPromptResult.

Target output size: ~2000-3000 tokens (tabs are simpler than grid/form).

**Update `mcp/prompts/index.ts`:**

Replace the stub prompt callbacks from Plan 01 with the real builder functions:

1. Add imports at top:
   ```typescript
   import {buildGridPrompt} from './grid.js';
   import {buildFormPrompt} from './form.js';
   import {buildTabsPrompt} from './tabs.js';
   ```

2. Replace each stub callback:
   - `create-grid`: callback becomes `async ({dataFields, features}) => buildGridPrompt({dataFields, features})`
   - `create-form`: callback becomes `async ({fields, validation}) => buildFormPrompt({fields, validation})`
   - `create-tab-container`: callback becomes `async ({tabs, routing}) => buildTabsPrompt({tabs, routing})`

Keep all the existing `title`, `description`, and `argsSchema` configurations unchanged from Plan 01.
  </action>
  <verify>
1. Run `npx tsc -p mcp/tsconfig.json --noEmit` -- no type errors.
2. Start the MCP server: `npx tsx mcp/server.ts 2>&1 | head -10` -- confirm all registrations succeed.
3. Verify each prompt builder can be invoked directly for a smoke test (optional: create a quick script or test the MCP server interactively).
  </verify>
  <done>
`mcp/prompts/tabs.ts` exports `buildTabsPrompt` with full tab container composition. `mcp/prompts/index.ts` is updated to wire all 3 real builders into prompt registrations. MCP server starts cleanly with 3 fully functional developer prompts. Phase 4 success criteria met: at least 3 MCP Prompts producing structured output with documentation and type references.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc -p mcp/tsconfig.json --noEmit` passes with zero errors
2. MCP server starts and logs "Registered 3 developer prompts"
3. Each prompt builder produces structured markdown with: conventions section, doc excerpts, type info, code template, next steps
4. Prompts adapt their output based on provided arguments (e.g. dataFields generates matching columns in grid prompt)
5. No prompt embeds an entire README -- only relevant extracted sections
6. All prompts reference MCP tools (hoist-search-docs, hoist-get-members, hoist-search-symbols) for further exploration
</verification>

<success_criteria>
- Three prompt builders produce structured, actionable output combining documentation + type info + conventions + code templates
- Output size is in the 2000-4000 token range (useful but not context-overwhelming)
- Prompts are wired into the MCP registration and invokable via the MCP protocol
- Phase 4 success criteria from ROADMAP.md are fully satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/04-developer-prompts/04-02-SUMMARY.md`
</output>
